<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>twittler</title>
  <link rel="stylesheet" href="assets/stylesheets/main.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300' rel='stylesheet' type='text/css'>

  <script src="jquery.js"></script>
  <script src="data_generator.js"></script>
</head>

<body>

  <!-- Header -->

  <header class="primary-header container group">

    <h1 class="logo">
      <a id="main-logo" href="index.html">twittler</a>
    </h1>

    <nav class="nav primary-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

  </header>

  <!-- Main Body -->
  <section class="primary-body">

    <h2 class="body-header">
      Home Feed
    </h2>

    <btn class="auto-update">
      Auto Update
    </btn>

    <btn class="refresh">
      Refresh
    </btn>

    <ul class="tweet-list"></ul>


    <script>



    function refreshFeed() {
      var home = (currentUser == "Twittler");
      var $body = $('.tweet-list');
      clearFeed($body);
      var stream = home ? streams.home : streams.users[currentUser];
      var totalNumTweets = stream.length
      for(var index = totalNumTweets - 1; index >= 0 && index > totalNumTweets - 15; index--) {
        newTweet = makeTweet(stream, index);
        newTweet.appendTo($body);
      }
    }

    function makeTweet(stream, index) {

      var tweet = stream[index];
      // Create nodes for tweet
      var $tweet = $("<li class='tweet-container'></li>");
      var $handle = $("<a onclick='updateProfile.apply(this)' class='tweet-handle'></a>");
      var $text = $("<div class='tweet-text'></div>");

      // Combine nodes
      $handle.text('@' + tweet.user);
      $text.text(tweet.message);
      $handle.appendTo($tweet);
      $text.appendTo($tweet);


      return $tweet;
    }

    function updateProfile() {
      currentUser = this.text.slice(1)
      $('#main-logo').text(currentUser);
    }


    function clearFeed(nodeToClear) {
      while (nodeToClear[0].firstChild) {
        nodeToClear[0].removeChild(nodeToClear[0].firstChild);
      }
    }


    var currentUser = "Twittler";
    var home = true;
    var autoUpdate = false;
    $(document).ready(refreshFeed);



    setInterval(refreshFeed, 200);

    </script>

  </section>

  <!-- Footer -->

  <footer class="primary-footer container group">

    <small>&copy; Twittler 2015</small>

    <nav class="nav">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

  </footer>

</body>
</html>
