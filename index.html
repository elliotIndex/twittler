<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>twittler</title>
  <link rel="stylesheet" href="assets/stylesheets/main.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300' rel='stylesheet' type='text/css'>

  <script src="jquery.js"></script>
  <script src="data_generator.js"></script>
</head>

<body>

  <!-- Header -->

  <header class="primary-header container group">

    <h1 class="logo">
      <a href="index.html">twittler</a>
    </h1>

    <nav class="nav primary-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

  </header>

  <!-- Main Body -->
  <section class="primary-body">

    <h2 class="body-header">
      Home Feed
    </h2>

    <ul class="tweet-list"></ul>


    <script>

    function refreshFeed() {
      var $body = $('.tweet-list');
      console.log($body);
      clearFeed($body);
      var totalNumTweets = streams.home.length
      var index = totalNumTweets - 1;
      for(; index >= 0 && index > totalNumTweets - 15; index--) {
        newTweet = makeTweet(index);
        newTweet.appendTo($body);
      }
    }

    function makeTweet(index) {
      var tweet = streams.home[index];

      // Create nodes for tweet
      var $tweet = $("<li class='tweet-container'></li>");
      var $handle = $("<div class='tweet-handle'></div>");
      var $text = $("<div class='tweet-text'></div>");

      // Combine nodes
      $handle.text('@' + tweet.user);
      $text.text(tweet.message);
      $handle.appendTo($tweet);
      $text.appendTo($tweet);

      return $tweet;
    }

    function clearFeed(nodeToClear) {
      while (nodeToClear[0].firstChild) {
        nodeToClear[0].removeChild(nodeToClear[0].firstChild);
      }
    }

    $(document).ready(refreshFeed);

    setInterval(refreshFeed, 500);

    </script>

  </section>

  <!-- Footer -->

  <footer class="primary-footer container group">

    <small>&copy; Twittler 2015</small>

    <nav class="nav">
      <ul>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

  </footer>

</body>
</html>
